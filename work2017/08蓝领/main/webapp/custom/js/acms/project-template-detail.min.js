function getProjectTemplate(){projectId&&$.get("/api/v1/acms/GetProjectTemplate",{project_id:projectId}).done(function(e){ajaxResHandle(e,function(){var a=e.context.template||{},t=e.context.description||{},s=e.context.rel_acts||[],i=e.context.resources||[],n=e.context.auth_type;modal(n),$(".banner").html('<h1 class="banner-info">'+(a.name?a.name:"")+'</h1>\n        <img src="'+(a.thumb?a.thumb:"//saascore.oss-cn-beijing.aliyuncs.com/mobile/custom/img/common/banner-common.png")+'" class="banner-img">\n        <ul class="banner-mask clearfix">\n            <li class="banner-mask_item">\n                <img src="//saascore.oss-cn-beijing.aliyuncs.com/mobile/custom/img/acms/hot.png" class="banner-mask_hot">\n            </li>\n            <li class="banner-mask_item">\n                <span>'+(a.actsCount?a.actsCount:"0")+'</span>个活动使用\n            </li>\n            <li class="banner-mask_item spread">\n                #'+a.templateType.name+"\n            </li>\n        </ul>"),$('[data-info="templateName"]').html(a.name),$('[data-info="memo"]').html(t.memo),$('[data-info="suggest"]').html(t.suggest);var c="";if(i.length>0)for(var l=0,o=i.length;l<o;l++)c+='<div class="swiper-slide">\n                        <a href="'+i[l].resource+'">\n                            <div class="img-container">\n                                <img src="'+i[l].resource+'" alt="">\n                            </div>\n                            <p class="template-demo_desc text-center">'+i[l].title+"</p>\n                        </a>\n                    </div>";else c='<div class="swiper-slide">暂无数据</div>';$(".template-demo .swiper-wrapper").html(c),$(".case-demo .swiper-wrapper").html(tmpl("template_caselist",{relActs:s})),swiper(),0===n&&($(".prompt").show(),$("[data-cj=createAct]").removeClass("disabled"))})})}function swiper(){new Swiper(".template-demo",{slidesPerView:"auto",spaceBetween:20,breakpoints:{1024:{slidesPerView:5,spaceBetween:40},768:{slidesPerView:4.5,spaceBetween:30},640:{slidesPerView:3.4,spaceBetween:20}},onImagesReady:function(e){baguetteBox.run(".template-demo",{animation:"fadeIn"})}}),new Swiper(".case-demo",{slidesPerView:"auto",spaceBetween:20,breakpoints:{1024:{slidesPerView:5,spaceBetween:40},768:{slidesPerView:4.5,spaceBetween:30},640:{slidesPerView:2,spaceBetween:20}}})}function modal(e){$("[data-cj=modal]").on("click",function(e){$(this).is("a")&&e.preventDefault();var a=$(this).attr("href")||$(this).data("target");e=$.Event("shown.cj.modal",{relatedTarget:this}),$(a).trigger(e),$.when($(a).removeClass("hide")).done(function(){$(a).addClass("in")}),$("[data-dismiss=modal]").off().click(function(e){$(this).is("a")&&e.preventDefault();var a=$(this).closest(".modal");e=$.Event("hidden.cj.modal"),$(a).trigger(e),$.when($(a).removeClass("in")).done(function(){$(a).addClass("hide")})})}),$("#modal").on("shown.cj.modal",function(e){$("html").addClass("html-unscrollable"),$(this).click(function(){$("[data-dismiss=modal]").trigger("click")}).find(".modal-content").click(function(e){e.stopPropagation()})}).on("hidden.cj.modal",function(a){$("html").removeClass("html-unscrollable"),$("[data-cj=createAct]").data("appid","").data("compappid",""),0!==e&&$("[data-cj=createAct]").addClass("disabled"),$(".wechat-list [data-appid].active").removeClass("active"),$(this).find(".validate-error").html("")}),$(".wechat-list").on("click","[data-appid]",function(){$(this).hasClass("active")||($(".wechat-list [data-appid].active").removeClass("active"),$(this).addClass("active"),$("[data-cj=createAct]").data("appid",$(this).data("appid")).data("compappid",$(this).data("compappid")).removeClass("disabled"))}),$("[data-cj=createAct]").click(function(){var a=this;if(!$(this).hasClass("disabled")){var t=$.trim($(this).data("appid"))||"",s=$.trim($(this).data("compappid"))||"";0!==e&&(t.length<=0||s.length<=0)?$("#modal").find(".validate-error").html("选择的公众号信息不全！"):($(this).addClass("disabled"),setTimeout(function(){$(a).removeClass("disabled")},3e3),$.post("/api/v1/acms/GenerateActivity",{project_id:projectId,appid:t,comp_appid:s}).done(function(e){ajaxResHandle(e,function(){location.href="/html/acms/project-template-main.html?activityid="+e.context.activityId})}))}})}var projectId=$.getSingleParam("projectid");getProjectTemplate(),$.get("/api/v1/acms/GetWechatHostings").done(function(e){ajaxResHandle(e,function(){var a=e.context||[];if($(".wechat-list").html(""),a.length>0)for(var t=0,s=a.length;t<s;t++)$(".wechat-list").append('<li class="wechat-item" data-appid="'+a[t].authorizerAppid+'" data-compappid="'+a[t].compAppid+'">\n                <a href="javascript:;" class="wechat-item_content">\n                    <img class="wechat-logo" src="'+a[t].avatar+'" alt="logo">\n                    <div class="wechat-name">'+a[t].nickname+'</div>\n                    <span class="plus_red"></span>\n                </a>\n            </li>');else $(".wechat-list").html('<li class="nodata-container">\n<img src="//saascore.oss-cn-beijing.aliyuncs.com/mobile/custom/img/acms/nodata.png" alt="" class="nodata-img">\n<div class="nodata-info">暂无绑定的公众号</div>\n                </li>')})});